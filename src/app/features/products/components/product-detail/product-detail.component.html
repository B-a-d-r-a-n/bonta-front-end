<div class="container mx-auto px-4 py-8">
  <div class="max-w-6xl mx-auto">
    @if (isProductLoading()) {
    <div class="flex justify-center items-center h-64">
      <div
        class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"
      ></div>
    </div>
    } @else if (productError()) {
    <div
      class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"
    >
      <strong>Error:</strong> Failed to load product details.
    </div>
    } @else { @if (productData(); as product) {
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- Product Image -->
      <div class="space-y-4">
        <div
          class="aspect-square bg-gray-100 dark:bg-slate-800 rounded-lg overflow-hidden"
        >
          <img
            [src]="product.pictureUrl"
            [alt]="product.name"
            class="w-full h-full object-cover"
          />
        </div>
        <div class="flex space-x-2">
          <div
            class="w-20 h-20 bg-gray-100 dark:bg-slate-800 rounded-lg overflow-hidden"
          >
            <img
              [src]="product.pictureUrl"
              [alt]="product.name"
              class="w-full h-full object-cover"
            />
          </div>
          <div
            class="w-20 h-20 bg-gray-100 dark:bg-slate-800 rounded-lg overflow-hidden"
          >
            <img
              [src]="product.pictureUrl"
              [alt]="product.name"
              class="w-full h-full object-cover"
            />
          </div>
          <div
            class="w-20 h-20 bg-gray-100 dark:bg-slate-800 rounded-lg overflow-hidden"
          >
            <img
              [src]="product.pictureUrl"
              [alt]="product.name"
              class="w-full h-full object-cover"
            />
          </div>
        </div>
      </div>

      <!-- Product Information -->
      <div class="space-y-6">
        <div>
          <h1
            id="product-header"
            class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2"
          >
            {{ product.name }}
          </h1>
          <div class="flex items-center space-x-4 mb-4">
            <div class="flex items-center">
              <i class="pi pi-star-fill text-yellow-400 mr-1"></i>
              <span class="text-sm text-gray-600 dark:text-gray-400"
                >4.5 (128 reviews)</span
              >
            </div>
            <div class="flex items-center">
              <i class="pi pi-tag text-gray-400 dark:text-gray-500 mr-1"></i>
              <span class="text-sm text-gray-600 dark:text-gray-400">{{
                product.productBrand
              }}</span>
            </div>
          </div>
          <div class="text-3xl font-bold text-blue-600 mb-4">
            {{ product.price | currency }}
          </div>
        </div>

        <!-- Product Description -->
        <div>
          <h3
            class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2"
          >
            Description
          </h3>
          <p class="text-gray-600 dark:text-gray-300 leading-relaxed">
            {{ product.description }}
          </p>
        </div>

        <!-- Product Details -->
        <div class="space-y-3">
          <div class="flex justify-between">
            <span class="text-gray-600 dark:text-gray-400">Brand</span>
            <span class="font-medium">{{ product.productBrand }}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 dark:text-gray-400">Type</span>
            <span class="font-medium">{{ product.productType }}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 dark:text-gray-400">Availability</span>
            <span class="text-green-600 font-medium">In Stock</span>
          </div>
        </div>

        <!-- Quantity and Add to Cart -->
        <div class="space-y-4">
          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >
              Quantity
            </label>
            <div class="flex items-center space-x-3">
              <p-button
                icon="pi pi-minus"
                styleClass="p-button-sm p-button-outlined"
                (click)="decreaseQuantity()"
                [disabled]="quantity() <= 1"
              ></p-button>
              <span class="text-lg font-medium w-12 text-center">{{
                quantity()
              }}</span>
              <p-button
                icon="pi pi-plus"
                styleClass="p-button-sm p-button-outlined"
                (click)="increaseQuantity()"
              ></p-button>
            </div>
          </div>

          <div class="flex space-x-3">
            <p-button
              label="Add to Cart"
              icon="pi pi-shopping-cart"
              styleClass="flex-1"
              [disabled]="cartDataService.updateBasketMutation.isPending()"
              [loading]="cartDataService.updateBasketMutation.isPending()"
              (click)="addToCart()"
            ></p-button>
            <p-button
              label="Add to Wishlist"
              icon="pi pi-heart"
              styleClass="p-button-outlined"
              (click)="addToWishlist()"
            ></p-button>
          </div>
        </div>

        <!-- Shipping Information -->
        <div class="bg-gray-50 dark:bg-slate-800 p-4 rounded-lg">
          <h4 class="font-semibold text-gray-900 dark:text-gray-100 mb-2">
            Shipping Information
          </h4>
          <div class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
            <div class="flex items-center">
              <i class="pi pi-truck mr-2"></i>
              <span>Free shipping on orders over $50</span>
            </div>
            <div class="flex items-center">
              <i class="pi pi-clock mr-2"></i>
              <span>Estimated delivery: 3-5 business days</span>
            </div>
            <div class="flex items-center">
              <i class="pi pi-undo mr-2"></i>
              <span>30-day return policy</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    } }

    <!-- Related Products -->
    <div class="mt-12">
      <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-6">
        Related Products
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        @for (i of [1, 2, 3, 4]; track i) {
        <div
          class="bg-white dark:bg-slate-800 rounded-lg shadow-md overflow-hidden"
        >
          <div class="aspect-square bg-gray-100 dark:bg-slate-700">
            <div
              class="w-full h-full bg-gray-200 dark:bg-slate-700 animate-pulse"
            ></div>
          </div>
          <div class="p-4">
            <div
              class="h-4 bg-gray-200 dark:bg-slate-700 rounded mb-2 animate-pulse"
            ></div>
            <div
              class="h-3 bg-gray-200 dark:bg-slate-700 rounded mb-2 animate-pulse"
            ></div>
            <div
              class="h-6 bg-gray-200 dark:bg-slate-700 rounded w-1/2 animate-pulse"
            ></div>
          </div>
        </div>
        }
      </div>
    </div>
  </div>
</div>

<p-toast></p-toast>
